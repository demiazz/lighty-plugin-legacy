{"version":3,"file":null,"sources":["../src/roles.js","../src/utils.js","../src/events.js","../src/index.js"],"sourcesContent":["import $ from 'jquery';\n\n/*\n * Copy from jquery.role by Sasha Koss https://github.com/kossnocorp/role\n */\nfunction rewriteSelector(context, name, position) {\n  const original = context[name];\n\n  if (!original) {\n    return;\n  }\n\n  context[name] = function replaceAliases(...args) {\n    args[position] = args[position].replace(\n      /@@([\\w\\u00c0-\\uFFFF\\-]+)/g, '[data-block~=\"$1\"]');\n    args[position] = args[position].replace(\n      /@([\\w\\u00c0-\\uFFFF\\-]+)/g, '[data-role~=\"$1\"]');\n\n    return original.apply(context, args);\n  };\n\n  $.extend(context[name], original);\n}\n\nrewriteSelector($, 'find', 0);\nrewriteSelector($, 'multiFilter', 0);\nrewriteSelector($.find, 'matchesSelector', 1);\nrewriteSelector($.find, 'matches', 0);\n\n\nexport default function transform(component) {\n  const nodes = component.$('[data-role]');\n\n  for (let i = 0; i < nodes.length; i += 1) {\n    const node = nodes[i];\n    const roles = node.attributes['data-role'].value.split(' ');\n\n    for (let j = 0; j < roles.length; j += 1) {\n      const role = roles[j];\n\n      if (!component[role]) {\n        component[role] = $();\n      }\n\n      if (component[role].jquery) {\n        component[role].push(node);\n      }\n    }\n  }\n}\n","function startsWithNative(string, substring) {\n  return string.startsWith(substring);\n}\n\nfunction startsWithPolyfill(string, substring) {\n  return string.substr(0, substring.length) === substring;\n}\n\nexport const startsWith = String.prototype.startsWith\n  ? startsWithNative\n  : startsWithPolyfill;\n\n\nfunction endsWithNative(string, substring) {\n  return string.endsWith(substring);\n}\n\nfunction endsWithPolyfill(string, substring) {\n  return string.substr(-substring.length) === substring;\n}\n\nexport const endsWith = String.prototype.endsWith\n  ? endsWithNative\n  : endsWithPolyfill;\n\n\nfunction includesNative(string, substring) {\n  return string.includes(substring);\n}\n\nfunction includesPolyfill(string, substring) {\n  return string.indexOf(substring) !== -1;\n}\n\nexport const includes = String.prototype.includes\n  ? includesNative\n  : includesPolyfill;\n","import $ from 'jquery';\n\nimport { startsWith, endsWith, includes } from './utils';\n\n\nfunction addBlockEventListener(component, property) {\n  const events = property.substr(3);\n  const listener = component[property];\n\n  component.block.on(events, function handleBlockEvent(e, ...data) {\n    if (e.currentTarget !== e.target) {\n      return;\n    }\n\n    listener.call(component, e, ...data);\n  });\n}\n\nlet loaded;\n\n$(window).on('load', (e) => {\n  loaded = e;\n});\n\nfunction addLoadEventListener(component, property) {\n  const listener = component[property];\n\n  if (!listener) {\n    return;\n  }\n\n  if (loaded) {\n    setTimeout(function handleLoadEvent() {\n      listener.call(component, loaded);\n    }, 1);\n  } else {\n    $(window).on('load', function handleLoadEvent(e) {\n      listener.call(component, e);\n    });\n  }\n}\n\nfunction addBodyEventListener(component, property) {\n  const events = property.split(' on ')[0];\n  const listener = component[property];\n\n  $('body').on(events, function handleBodyEvent(...args) {\n    listener.call(component, ...args);\n  });\n}\n\nfunction addWindowEventListener(component, property) {\n  const events = property.split(' on ')[0];\n  const listener = component[property];\n\n  $(window).on(events, function handleWindowEvent(...args) {\n    listener.call(component, ...args);\n  });\n}\n\nfunction addElementEventListener(component, property) {\n  const [events, selectors] = property.split(' on ');\n\n  if (!(events && selectors)) {\n    return;\n  }\n\n  const listener = component[property];\n\n  component.block.on(events, selectors, function handleEvent(...args) {\n    listener.call(component, ...args);\n  });\n}\n\nfunction getEventListener(property) {\n  if (startsWith(property, 'on ')) {\n    return addBlockEventListener;\n  }\n\n  if (property === 'load on window') {\n    return addLoadEventListener;\n  }\n\n  if (endsWith(property, ' on body')) {\n    return addBodyEventListener;\n  }\n\n  if (endsWith(property, ' on window')) {\n    return addWindowEventListener;\n  }\n\n  if (includes(property, ' on ')) {\n    return addElementEventListener;\n  }\n\n  return null;\n}\n\n\nexport default function transform(component) {\n  Object.keys(component).forEach((property) => {\n    const addEventListener = getEventListener(property);\n\n    if (!addEventListener) {\n      return;\n    }\n\n    addEventListener(component, property);\n\n    delete component[property];\n  });\n}\n","import $ from 'jquery';\nimport { plugin } from 'lighty';\n\nimport roles from './roles';\nimport events from './events';\n\n\nfunction pluginInitializer() {\n  return function transform(component, node) {\n    component.block = $(node);\n\n    component.$ = function findInBlock(selector) {\n      return $(selector, component.block);\n    };\n\n    roles(component);\n    events(component);\n  };\n}\n\n\nexport default plugin('legacy', pluginInitializer);\n"],"names":["const","transform","let","roles","events","plugin"],"mappings":"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"}